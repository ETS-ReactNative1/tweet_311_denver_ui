66013f2d6d454e8de63c2c8c1b981175
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.emitNotification = emitNotification;
exports.default = void 0;

var _regenerator = _interopRequireDefault(require("@babel/runtime/regenerator"));

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _expoConstants = _interopRequireDefault(require("expo-constants"));

var _fbemitter = require("fbemitter");

var _invariant = _interopRequireDefault(require("invariant"));

var _reactNative = require("react-native");

var _core = require("@unimodules/core");

var _ExponentNotifications = _interopRequireDefault(require("./ExponentNotifications"));

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0, _defineProperty2.default)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

var _emitter;

var _initialNotification;

function _maybeInitEmitter() {
  if (!_emitter) {
    _emitter = new _fbemitter.EventEmitter();

    _core.RCTDeviceEventEmitter.addListener('Exponent.notification', emitNotification);
  }
}

function emitNotification(notification) {
  if (typeof notification === 'string') {
    notification = JSON.parse(notification);
  }

  notification = _objectSpread({}, notification);

  if (typeof notification.data === 'string') {
    try {
      notification.data = JSON.parse(notification.data);
    } catch (e) {}
  }

  _emitter.emit('notification', notification);
}

function _processNotification(notification) {
  notification = (0, _extends2.default)({}, notification);

  if (!notification.data) {
    notification.data = {};
  }

  if (notification.hasOwnProperty('count')) {
    delete notification.count;
  }

  if (_reactNative.Platform.OS === 'ios') {
    if (notification.android) {
      delete notification.android;
    }

    if (notification.ios) {
      notification = (0, _extends2.default)(notification, notification.ios);
      notification.data._displayInForeground = notification.ios._displayInForeground;
      delete notification.ios;
    }
  }

  if (_reactNative.Platform.OS === 'android') {
    if (notification.ios) {
      delete notification.ios;
    }

    if (notification.android) {
      notification = (0, _extends2.default)(notification, notification.android);
      delete notification.android;
    }
  }

  return notification;
}

function _validateNotification(notification) {
  if (_reactNative.Platform.OS === 'ios') {
    (0, _invariant.default)(!!notification.title && !!notification.body, 'Local notifications on iOS require both a title and a body');
  } else if (_reactNative.Platform.OS === 'android') {
    (0, _invariant.default)(!!notification.title, 'Local notifications on Android require a title');
  }
}

var ASYNC_STORAGE_PREFIX = '__expo_internal_channel_';
var IS_USING_NEW_BINARY = typeof _ExponentNotifications.default.createChannel === 'function';

function _legacyReadChannel(id) {
  var channelString;
  return _regenerator.default.async(function _legacyReadChannel$(_context) {
    while (1) {
      switch (_context.prev = _context.next) {
        case 0:
          _context.prev = 0;
          _context.next = 3;
          return _regenerator.default.awrap(_reactNative.AsyncStorage.getItem("" + ASYNC_STORAGE_PREFIX + id));

        case 3:
          channelString = _context.sent;

          if (!channelString) {
            _context.next = 6;
            break;
          }

          return _context.abrupt("return", JSON.parse(channelString));

        case 6:
          _context.next = 10;
          break;

        case 8:
          _context.prev = 8;
          _context.t0 = _context["catch"](0);

        case 10:
          return _context.abrupt("return", null);

        case 11:
        case "end":
          return _context.stop();
      }
    }
  }, null, null, [[0, 8]]);
}

function _legacyDeleteChannel(id) {
  return _reactNative.AsyncStorage.removeItem("" + ASYNC_STORAGE_PREFIX + id);
}

if (_reactNative.Platform.OS === 'android') {
  _reactNative.AsyncStorage.clear = function _callee(callback) {
    var keys, filteredKeys;
    return _regenerator.default.async(function _callee$(_context2) {
      while (1) {
        switch (_context2.prev = _context2.next) {
          case 0:
            _context2.prev = 0;
            _context2.next = 3;
            return _regenerator.default.awrap(_reactNative.AsyncStorage.getAllKeys());

          case 3:
            keys = _context2.sent;

            if (!(keys && keys.length)) {
              _context2.next = 8;
              break;
            }

            filteredKeys = keys.filter(function (key) {
              return !key.startsWith(ASYNC_STORAGE_PREFIX);
            });
            _context2.next = 8;
            return _regenerator.default.awrap(_reactNative.AsyncStorage.multiRemove(filteredKeys));

          case 8:
            callback && callback();
            _context2.next = 15;
            break;

          case 11:
            _context2.prev = 11;
            _context2.t0 = _context2["catch"](0);
            callback && callback(_context2.t0);
            throw _context2.t0;

          case 15:
          case "end":
            return _context2.stop();
        }
      }
    }, null, null, [[0, 11]]);
  };
}

function _legacySaveChannel(id, channel) {
  return _reactNative.AsyncStorage.setItem("" + ASYNC_STORAGE_PREFIX + id, JSON.stringify(channel));
}

var _default = {
  _setInitialNotification: function _setInitialNotification(notification) {
    _initialNotification = notification;
  },
  createCategoryAsync: function createCategoryAsync(categoryId, actions) {
    return _ExponentNotifications.default.createCategoryAsync(categoryId, actions);
  },
  deleteCategoryAsync: function deleteCategoryAsync(categoryId) {
    return _ExponentNotifications.default.deleteCategoryAsync(categoryId);
  },
  getExpoPushTokenAsync: function getExpoPushTokenAsync() {
    if (!_ExponentNotifications.default.getExponentPushTokenAsync) {
      throw new _core.UnavailabilityError('Expo.Notifications', 'getExpoPushTokenAsync');
    }

    if (!_expoConstants.default.isDevice) {
      throw new Error("Must be on a physical device to get an Expo Push Token");
    }

    return _ExponentNotifications.default.getExponentPushTokenAsync();
  },
  getDevicePushTokenAsync: function getDevicePushTokenAsync(config) {
    if (!_ExponentNotifications.default.getDevicePushTokenAsync) {
      throw new _core.UnavailabilityError('Expo.Notifications', 'getDevicePushTokenAsync');
    }

    return _ExponentNotifications.default.getDevicePushTokenAsync(config || {});
  },
  createChannelAndroidAsync: function createChannelAndroidAsync(id, channel) {
    if (_reactNative.Platform.OS !== 'android') {
      console.warn("createChannelAndroidAsync(...) has no effect on " + _reactNative.Platform.OS);
      return Promise.resolve();
    }

    if (!IS_USING_NEW_BINARY) {
      return _legacySaveChannel(id, channel);
    }

    return _ExponentNotifications.default.createChannel(id, channel);
  },
  deleteChannelAndroidAsync: function deleteChannelAndroidAsync(id) {
    if (_reactNative.Platform.OS !== 'android') {
      console.warn("deleteChannelAndroidAsync(...) has no effect on " + _reactNative.Platform.OS);
      return Promise.resolve();
    }

    if (!IS_USING_NEW_BINARY) {
      return Promise.resolve();
    }

    return _ExponentNotifications.default.deleteChannel(id);
  },
  presentLocalNotificationAsync: function presentLocalNotificationAsync(notification) {
    var nativeNotification, _channel;

    return _regenerator.default.async(function presentLocalNotificationAsync$(_context3) {
      while (1) {
        switch (_context3.prev = _context3.next) {
          case 0:
            _validateNotification(notification);

            nativeNotification = _processNotification(notification);

            if (!(_reactNative.Platform.OS !== 'android')) {
              _context3.next = 8;
              break;
            }

            _context3.next = 5;
            return _regenerator.default.awrap(_ExponentNotifications.default.presentLocalNotification(nativeNotification));

          case 5:
            return _context3.abrupt("return", _context3.sent);

          case 8:
            if (!nativeNotification.channelId) {
              _context3.next = 12;
              break;
            }

            _context3.next = 11;
            return _regenerator.default.awrap(_legacyReadChannel(nativeNotification.channelId));

          case 11:
            _channel = _context3.sent;

          case 12:
            if (!IS_USING_NEW_BINARY) {
              _context3.next = 17;
              break;
            }

            _legacyDeleteChannel(nativeNotification.channelId);

            return _context3.abrupt("return", _ExponentNotifications.default.presentLocalNotificationWithChannel(nativeNotification, _channel));

          case 17:
            if (_channel) {
              nativeNotification.sound = _channel.sound;
              nativeNotification.priority = _channel.priority;
              nativeNotification.vibrate = _channel.vibrate;
            }

            return _context3.abrupt("return", _ExponentNotifications.default.presentLocalNotification(nativeNotification));

          case 19:
          case "end":
            return _context3.stop();
        }
      }
    });
  },
  scheduleLocalNotificationAsync: function scheduleLocalNotificationAsync(notification) {
    var options,
        now,
        nativeNotification,
        timeAsDateObj,
        validOptions,
        _channel,
        _args4 = arguments;

    return _regenerator.default.async(function scheduleLocalNotificationAsync$(_context4) {
      while (1) {
        switch (_context4.prev = _context4.next) {
          case 0:
            options = _args4.length > 1 && _args4[1] !== undefined ? _args4[1] : {};
            now = Date.now();

            _validateNotification(notification);

            nativeNotification = _processNotification(notification);

            if (!options.time) {
              _context4.next = 11;
              break;
            }

            timeAsDateObj = null;

            if (options.time && typeof options.time === 'number') {
              timeAsDateObj = new Date(options.time);

              if (timeAsDateObj.toString() === 'Invalid Date') {
                timeAsDateObj = null;
              }
            } else if (options.time && options.time instanceof Date) {
              timeAsDateObj = options.time;
            }

            if (timeAsDateObj) {
              _context4.next = 9;
              break;
            }

            throw new Error("Provided value for \"time\" is invalid. Please verify that it's either a number representing Unix Epoch time in milliseconds, or a valid date object.");

          case 9:
            if (timeAsDateObj.getTime() < now) {
              console.warn("Provided value for \"time\" is before the current date. Did you possibly pass number of seconds since Unix Epoch instead of number of milliseconds?");
            }

            options = _objectSpread({}, options, {
              time: timeAsDateObj.getTime()
            });

          case 11:
            if (!(options.intervalMs != null && options.repeat != null)) {
              _context4.next = 13;
              break;
            }

            throw new Error("Pass either the \"repeat\" option or \"intervalMs\" option, not both");

          case 13:
            if (!(options.repeat != null)) {
              _context4.next = 17;
              break;
            }

            validOptions = new Set(['minute', 'hour', 'day', 'week', 'month', 'year']);

            if (validOptions.has(options.repeat)) {
              _context4.next = 17;
              break;
            }

            throw new Error("Pass one of ['minute', 'hour', 'day', 'week', 'month', 'year'] as the value for the \"repeat\" option");

          case 17:
            if (!(options.intervalMs != null)) {
              _context4.next = 22;
              break;
            }

            if (!(_reactNative.Platform.OS === 'ios')) {
              _context4.next = 20;
              break;
            }

            throw new Error("The \"intervalMs\" option is not supported on iOS");

          case 20:
            if (!(options.intervalMs <= 0 || !Number.isInteger(options.intervalMs))) {
              _context4.next = 22;
              break;
            }

            throw new Error("Pass an integer greater than zero as the value for the \"intervalMs\" option");

          case 22:
            if (!(_reactNative.Platform.OS !== 'android')) {
              _context4.next = 29;
              break;
            }

            if (!options.repeat) {
              _context4.next = 26;
              break;
            }

            console.warn('Ability to schedule an automatically repeated notification is deprecated on iOS and will be removed in the next SDK release.');
            return _context4.abrupt("return", _ExponentNotifications.default.legacyScheduleLocalRepeatingNotification(nativeNotification, options));

          case 26:
            return _context4.abrupt("return", _ExponentNotifications.default.scheduleLocalNotification(nativeNotification, options));

          case 29:
            if (!nativeNotification.channelId) {
              _context4.next = 33;
              break;
            }

            _context4.next = 32;
            return _regenerator.default.awrap(_legacyReadChannel(nativeNotification.channelId));

          case 32:
            _channel = _context4.sent;

          case 33:
            if (!IS_USING_NEW_BINARY) {
              _context4.next = 38;
              break;
            }

            _legacyDeleteChannel(nativeNotification.channelId);

            return _context4.abrupt("return", _ExponentNotifications.default.scheduleLocalNotificationWithChannel(nativeNotification, options, _channel));

          case 38:
            if (_channel) {
              nativeNotification.sound = _channel.sound;
              nativeNotification.priority = _channel.priority;
              nativeNotification.vibrate = _channel.vibrate;
            }

            return _context4.abrupt("return", _ExponentNotifications.default.scheduleLocalNotification(nativeNotification, options));

          case 40:
          case "end":
            return _context4.stop();
        }
      }
    });
  },
  dismissNotificationAsync: function dismissNotificationAsync(notificationId) {
    return _regenerator.default.async(function dismissNotificationAsync$(_context5) {
      while (1) {
        switch (_context5.prev = _context5.next) {
          case 0:
            if (_ExponentNotifications.default.dismissNotification) {
              _context5.next = 2;
              break;
            }

            throw new _core.UnavailabilityError('Expo.Notifications', 'dismissNotification');

          case 2:
            _context5.next = 4;
            return _regenerator.default.awrap(_ExponentNotifications.default.dismissNotification(notificationId));

          case 4:
            return _context5.abrupt("return", _context5.sent);

          case 5:
          case "end":
            return _context5.stop();
        }
      }
    });
  },
  dismissAllNotificationsAsync: function dismissAllNotificationsAsync() {
    return _regenerator.default.async(function dismissAllNotificationsAsync$(_context6) {
      while (1) {
        switch (_context6.prev = _context6.next) {
          case 0:
            if (_ExponentNotifications.default.dismissAllNotifications) {
              _context6.next = 2;
              break;
            }

            throw new _core.UnavailabilityError('Expo.Notifications', 'dismissAllNotifications');

          case 2:
            _context6.next = 4;
            return _regenerator.default.awrap(_ExponentNotifications.default.dismissAllNotifications());

          case 4:
            return _context6.abrupt("return", _context6.sent);

          case 5:
          case "end":
            return _context6.stop();
        }
      }
    });
  },
  cancelScheduledNotificationAsync: function cancelScheduledNotificationAsync(notificationId) {
    if (_reactNative.Platform.OS === 'android' && typeof notificationId === 'string') {
      return _ExponentNotifications.default.cancelScheduledNotificationWithStringIdAsync(notificationId);
    }

    return _ExponentNotifications.default.cancelScheduledNotificationAsync(notificationId);
  },
  cancelAllScheduledNotificationsAsync: function cancelAllScheduledNotificationsAsync() {
    return _ExponentNotifications.default.cancelAllScheduledNotificationsAsync();
  },
  addListener: function addListener(listener) {
    _maybeInitEmitter();

    if (_initialNotification) {
      var initialNotification = _initialNotification;
      _initialNotification = null;
      setTimeout(function () {
        emitNotification(initialNotification);
      }, 0);
    }

    return _emitter.addListener('notification', listener);
  },
  getBadgeNumberAsync: function getBadgeNumberAsync() {
    return _regenerator.default.async(function getBadgeNumberAsync$(_context7) {
      while (1) {
        switch (_context7.prev = _context7.next) {
          case 0:
            if (_ExponentNotifications.default.getBadgeNumberAsync) {
              _context7.next = 2;
              break;
            }

            return _context7.abrupt("return", 0);

          case 2:
            return _context7.abrupt("return", _ExponentNotifications.default.getBadgeNumberAsync());

          case 3:
          case "end":
            return _context7.stop();
        }
      }
    });
  },
  setBadgeNumberAsync: function setBadgeNumberAsync(number) {
    return _regenerator.default.async(function setBadgeNumberAsync$(_context8) {
      while (1) {
        switch (_context8.prev = _context8.next) {
          case 0:
            if (_ExponentNotifications.default.setBadgeNumberAsync) {
              _context8.next = 2;
              break;
            }

            throw new _core.UnavailabilityError('Expo.Notifications', 'setBadgeNumberAsync');

          case 2:
            return _context8.abrupt("return", _ExponentNotifications.default.setBadgeNumberAsync(number));

          case 3:
          case "end":
            return _context8.stop();
        }
      }
    });
  },
  scheduleNotificationWithCalendarAsync: function scheduleNotificationWithCalendarAsync(notification) {
    var options,
        areOptionsValid,
        nativeNotification,
        _args9 = arguments;
    return _regenerator.default.async(function scheduleNotificationWithCalendarAsync$(_context9) {
      while (1) {
        switch (_context9.prev = _context9.next) {
          case 0:
            options = _args9.length > 1 && _args9[1] !== undefined ? _args9[1] : {};
            areOptionsValid = (options.month == null || isInRangeInclusive(options.month, 1, 12)) && (options.day == null || isInRangeInclusive(options.day, 1, 31)) && (options.hour == null || isInRangeInclusive(options.hour, 0, 23)) && (options.minute == null || isInRangeInclusive(options.minute, 0, 59)) && (options.second == null || isInRangeInclusive(options.second, 0, 59)) && (options.weekDay == null || isInRangeInclusive(options.weekDay, 1, 7)) && (options.weekDay == null || options.day == null);

            if (areOptionsValid) {
              _context9.next = 4;
              break;
            }

            throw new _core.CodedError('WRONG_OPTIONS', 'Options in scheduleNotificationWithCalendarAsync call were incorrect!');

          case 4:
            _validateNotification(notification);

            nativeNotification = _processNotification(notification);
            return _context9.abrupt("return", _ExponentNotifications.default.scheduleNotificationWithCalendar(nativeNotification, options));

          case 7:
          case "end":
            return _context9.stop();
        }
      }
    });
  },
  scheduleNotificationWithTimerAsync: function scheduleNotificationWithTimerAsync(notification, options) {
    var nativeNotification;
    return _regenerator.default.async(function scheduleNotificationWithTimerAsync$(_context10) {
      while (1) {
        switch (_context10.prev = _context10.next) {
          case 0:
            if (!(options.interval < 1)) {
              _context10.next = 2;
              break;
            }

            throw new _core.CodedError('WRONG_OPTIONS', 'Interval must be not less then 1');

          case 2:
            _validateNotification(notification);

            nativeNotification = _processNotification(notification);
            return _context10.abrupt("return", _ExponentNotifications.default.scheduleNotificationWithTimer(nativeNotification, options));

          case 5:
          case "end":
            return _context10.stop();
        }
      }
    });
  }
};
exports.default = _default;

function isInRangeInclusive(variable, min, max) {
  return variable >= min && variable <= max;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9Ob3RpZmljYXRpb25zL05vdGlmaWNhdGlvbnMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7Ozs7O0FBUUEsSUFBSSxRQUFKOztBQUNBLElBQUksb0JBQUo7O0FBRUEsU0FBUyxpQkFBVCxHQUEwQjtBQUN4QixNQUFJLENBQUMsUUFBTCxFQUFlO0FBQ2IsSUFBQSxRQUFRLEdBQUcsSUFBSSx1QkFBSixFQUFYOztBQUNBLGdDQUFzQixXQUF0QixDQUFrQyx1QkFBbEMsRUFBMkQsZ0JBQTNEO0FBQ0Q7QUFDRjs7QUFFSyxTQUFVLGdCQUFWLENBQTJCLFlBQTNCLEVBQXVDO0FBQzNDLE1BQUksT0FBTyxZQUFQLEtBQXdCLFFBQTVCLEVBQXNDO0FBQ3BDLElBQUEsWUFBWSxHQUFHLElBQUksQ0FBQyxLQUFMLENBQVcsWUFBWCxDQUFmO0FBQ0Q7O0FBR0QsRUFBQSxZQUFZLHFCQUFRLFlBQVIsQ0FBWjs7QUFFQSxNQUFJLE9BQU8sWUFBWSxDQUFDLElBQXBCLEtBQTZCLFFBQWpDLEVBQTJDO0FBQ3pDLFFBQUk7QUFDRixNQUFBLFlBQVksQ0FBQyxJQUFiLEdBQW9CLElBQUksQ0FBQyxLQUFMLENBQVcsWUFBWSxDQUFDLElBQXhCLENBQXBCO0FBQ0QsS0FGRCxDQUVFLE9BQU8sQ0FBUCxFQUFVLENBRVg7QUFDRjs7QUFFRCxFQUFBLFFBQVEsQ0FBQyxJQUFULENBQWMsY0FBZCxFQUE4QixZQUE5QjtBQUNEOztBQUVELFNBQVMsb0JBQVQsQ0FBOEIsWUFBOUIsRUFBMEM7QUFDeEMsRUFBQSxZQUFZLEdBQUcsdUJBQWMsRUFBZCxFQUFrQixZQUFsQixDQUFmOztBQUVBLE1BQUksQ0FBQyxZQUFZLENBQUMsSUFBbEIsRUFBd0I7QUFDdEIsSUFBQSxZQUFZLENBQUMsSUFBYixHQUFvQixFQUFwQjtBQUNEOztBQUVELE1BQUksWUFBWSxDQUFDLGNBQWIsQ0FB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QkF1VFAsT0FBTyxDQUFDLFFBQVIsR0FBbUIsQ0F2VFo7QUFBQTtBQUFBO0FBQUE7O0FBQUEsa0JBd1RILElBQUksZ0JBQUosQ0FBZSxlQUFmLEVBQWdDLGtDQUFoQyxDQXhURzs7QUFBQTtBQTJUWCxZQUFBLHFCQUFxQixDQUFDLFlBQUQsQ0FBckI7O0FBQ0ksWUFBQSxrQkE1VE8sR0E0VGMsb0JBQW9CLENBQUMsWUFBRCxDQTVUbEM7QUFBQSwrQ0E4VEosK0JBQXNCLDZCQUF0QixDQUFvRCxrQkFBcEQsRUFBd0UsT0FBeEUsQ0E5VEk7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxDOzs7QUFrVWYsU0FBUyxrQkFBVCxDQUE0QixRQUE1QixFQUE4QyxHQUE5QyxFQUEyRCxHQUEzRCxFQUFzRTtBQUNwRSxTQUFPLFFBQVEsSUFBSSxHQUFaLElBQW1CLFFBQVEsSUFBSSxHQUF0QztBQUNEIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IENvbnN0YW50cyBmcm9tICdleHBvLWNvbnN0YW50cyc7XG5pbXBvcnQgeyBFdmVudEVtaXR0ZXIsIEV2ZW50U3Vic2NyaXB0aW9uIH0gZnJvbSAnZmJlbWl0dGVyJztcbmltcG9ydCBpbnZhcmlhbnQgZnJvbSAnaW52YXJpYW50JztcbmltcG9ydCB7IEFzeW5jU3RvcmFnZSwgUGxhdGZvcm0gfSBmcm9tICdyZWFjdC1uYXRpdmUnO1xuaW1wb3J0IHsgQ29kZWRFcnJvciwgUkNURGV2aWNlRXZlbnRFbWl0dGVyLCBVbmF2YWlsYWJpbGl0eUVycm9yIH0gZnJvbSAnQHVuaW1vZHVsZXMvY29yZSc7XG5pbXBvcnQgRXhwb25lbnROb3RpZmljYXRpb25zIGZyb20gJy4vRXhwb25lbnROb3RpZmljYXRpb25zJztcbmltcG9ydCB7XG4gIE5vdGlmaWNhdGlvbixcbiAgTG9jYWxOb3RpZmljYXRpb24sXG4gIENoYW5uZWwsXG4gIEFjdGlvblR5cGUsXG4gIExvY2FsTm90aWZpY2F0aW9uSWQsXG59IGZyb20gJy4vTm90aWZpY2F0aW9ucy50eXBlcyc7XG5sZXQgX2VtaXR0ZXI7XG5sZXQgX2luaXRpYWxOb3RpZmljYXRpb247XG5cbmZ1bmN0aW9uIF9tYXliZUluaXRFbWl0dGVyKCkge1xuICBpZiAoIV9lbWl0dGVyKSB7XG4gICAgX2VtaXR0ZXIgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgUkNURGV2aWNlRXZlbnRFbWl0dGVyLmFkZExpc3RlbmVyKCdFeHBvbmVudC5ub3RpZmljYXRpb24nLCBlbWl0Tm90aWZpY2F0aW9uKTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZW1pdE5vdGlmaWNhdGlvbihub3RpZmljYXRpb24pIHtcbiAgaWYgKHR5cGVvZiBub3RpZmljYXRpb24gPT09ICdzdHJpbmcnKSB7XG4gICAgbm90aWZpY2F0aW9uID0gSlNPTi5wYXJzZShub3RpZmljYXRpb24pO1xuICB9XG5cbiAgLyogRG9uJ3QgbXV0YXRlIHRoZSBvcmlnaW5hbCBub3RpZmljYXRpb24gKi9cbiAgbm90aWZpY2F0aW9uID0geyAuLi5ub3RpZmljYXRpb24gfTtcblxuICBpZiAodHlwZW9mIG5vdGlmaWNhdGlvbi5kYXRhID09PSAnc3RyaW5nJykge1xuICAgIHRyeSB7XG4gICAgICBub3RpZmljYXRpb24uZGF0YSA9IEpTT04ucGFyc2Uobm90aWZpY2F0aW9uLmRhdGEpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIC8vIEl0J3MgYWN0dWFsbHkganVzdCBhIHN0cmluZywgdGhhdCdzIGZpbmVcbiAgICB9XG4gIH1cblxuICBfZW1pdHRlci5lbWl0KCdub3RpZmljYXRpb24nLCBub3RpZmljYXRpb24pO1xufVxuXG5mdW5jdGlvbiBfcHJvY2Vzc05vdGlmaWNhdGlvbihub3RpZmljYXRpb24pIHtcbiAgbm90aWZpY2F0aW9uID0gT2JqZWN0LmFzc2lnbih7fSwgbm90aWZpY2F0aW9uKTtcblxuICBpZiAoIW5vdGlmaWNhdGlvbi5kYXRhKSB7XG4gICAgbm90aWZpY2F0aW9uLmRhdGEgPSB7fTtcbiAgfVxuXG4gIGlmIChub3RpZmljYXRpb24uaGFzT3duUHJvcGVydHkoJ2NvdW50JykpIHtcbiAgICBkZWxldGUgbm90aWZpY2F0aW9uLmNvdW50O1xuICB9XG5cbiAgLy8gRGVsZXRlIGFueSBBbmRyb2lkIHByb3BlcnRpZXMgb24gaU9TIGFuZCBtZXJnZSB0aGUgaU9TIHByb3BlcnRpZXMgb24gcm9vdCBub3RpZmljYXRpb24gb2JqZWN0XG4gIGlmIChQbGF0Zm9ybS5PUyA9PT0gJ2lvcycpIHtcbiAgICBpZiAobm90aWZpY2F0aW9uLmFuZHJvaWQpIHtcbiAgICAgIGRlbGV0ZSBub3RpZmljYXRpb24uYW5kcm9pZDtcbiAgICB9XG5cbiAgICBpZiAobm90aWZpY2F0aW9uLmlvcykge1xuICAgICAgbm90aWZpY2F0aW9uID0gT2JqZWN0LmFzc2lnbihub3RpZmljYXRpb24sIG5vdGlmaWNhdGlvbi5pb3MpO1xuICAgICAgbm90aWZpY2F0aW9uLmRhdGEuX2Rpc3BsYXlJbkZvcmVncm91bmQgPSBub3RpZmljYXRpb24uaW9zLl9kaXNwbGF5SW5Gb3JlZ3JvdW5kO1xuICAgICAgZGVsZXRlIG5vdGlmaWNhdGlvbi5pb3M7XG4gICAgfVxuICB9XG5cbiAgLy8gRGVsZXRlIGFueSBpT1MgcHJvcGVydGllcyBvbiBBbmRyb2lkIGFuZCBtZXJnZSB0aGUgQW5kcm9pZCBwcm9wZXJ0aWVzIG9uIHJvb3Qgbm90aWZpY2F0aW9uXG4gIC8vIG9iamVjdFxuICBpZiAoUGxhdGZvcm0uT1MgPT09ICdhbmRyb2lkJykge1xuICAgIGlmIChub3RpZmljYXRpb24uaW9zKSB7XG4gICAgICBkZWxldGUgbm90aWZpY2F0aW9uLmlvcztcbiAgICB9XG5cbiAgICBpZiAobm90aWZpY2F0aW9uLmFuZHJvaWQpIHtcbiAgICAgIG5vdGlmaWNhdGlvbiA9IE9iamVjdC5hc3NpZ24obm90aWZpY2F0aW9uLCBub3RpZmljYXRpb24uYW5kcm9pZCk7XG4gICAgICBkZWxldGUgbm90aWZpY2F0aW9uLmFuZHJvaWQ7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIG5vdGlmaWNhdGlvbjtcbn1cblxuZnVuY3Rpb24gX3ZhbGlkYXRlTm90aWZpY2F0aW9uKG5vdGlmaWNhdGlvbikge1xuICBpZiAoUGxhdGZvcm0uT1MgPT09ICdpb3MnKSB7XG4gICAgaW52YXJpYW50KFxuICAgICAgISFub3RpZmljYXRpb24udGl0bGUgJiYgISFub3RpZmljYXRpb24uYm9keSxcbiAgICAgICdMb2NhbCBub3RpZmljYXRpb25zIG9uIGlPUyByZXF1aXJlIGJvdGggYSB0aXRsZSBhbmQgYSBib2R5J1xuICAgICk7XG4gIH0gZWxzZSBpZiAoUGxhdGZvcm0uT1MgPT09ICdhbmRyb2lkJykge1xuICAgIGludmFyaWFudCghIW5vdGlmaWNhdGlvbi50aXRsZSwgJ0xvY2FsIG5vdGlmaWNhdGlvbnMgb24gQW5kcm9pZCByZXF1aXJlIGEgdGl0bGUnKTtcbiAgfVxufVxuXG5sZXQgQVNZTkNfU1RPUkFHRV9QUkVGSVggPSAnX19leHBvX2ludGVybmFsX2NoYW5uZWxfJztcbi8vIFRPRE86IHJlbW92ZSB0aGlzIGJlZm9yZSByZWxlYXNpbmdcbi8vIHRoaXMgd2lsbCBhbHdheXMgYmUgYHRydWVgIGZvciBTREsgMjgrXG5sZXQgSVNfVVNJTkdfTkVXX0JJTkFSWSA9IHR5cGVvZiBFeHBvbmVudE5vdGlmaWNhdGlvbnMuY3JlYXRlQ2hhbm5lbCA9PT0gJ2Z1bmN0aW9uJztcblxuYXN5bmMgZnVuY3Rpb24gX2xlZ2FjeVJlYWRDaGFubmVsKGlkOiBzdHJpbmcpOiBQcm9taXNlPENoYW5uZWwgfCBudWxsPiB7XG4gIHRyeSB7XG4gICAgbGV0IGNoYW5uZWxTdHJpbmcgPSBhd2FpdCBBc3luY1N0b3JhZ2UuZ2V0SXRlbShgJHtBU1lOQ19TVE9SQUdFX1BSRUZJWH0ke2lkfWApO1xuICAgIGlmIChjaGFubmVsU3RyaW5nKSB7XG4gICAgICByZXR1cm4gSlNPTi5wYXJzZShjaGFubmVsU3RyaW5nKTtcbiAgICB9XG4gIH0gY2F0Y2ggKGUpIHt9XG4gIHJldHVybiBudWxsO1xufVxuXG5mdW5jdGlvbiBfbGVnYWN5RGVsZXRlQ2hhbm5lbChpZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gIHJldHVybiBBc3luY1N0b3JhZ2UucmVtb3ZlSXRlbShgJHtBU1lOQ19TVE9SQUdFX1BSRUZJWH0ke2lkfWApO1xufVxuXG5pZiAoUGxhdGZvcm0uT1MgPT09ICdhbmRyb2lkJykge1xuICBBc3luY1N0b3JhZ2UuY2xlYXIgPSBhc3luYyBmdW5jdGlvbihjYWxsYmFjaz86IChlcnJvcj86IEVycm9yKSA9PiB2b2lkKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGxldCBrZXlzID0gYXdhaXQgQXN5bmNTdG9yYWdlLmdldEFsbEtleXMoKTtcbiAgICAgIGlmIChrZXlzICYmIGtleXMubGVuZ3RoKSB7XG4gICAgICAgIGxldCBmaWx0ZXJlZEtleXMgPSBrZXlzLmZpbHRlcihrZXkgPT4gIWtleS5zdGFydHNXaXRoKEFTWU5DX1NUT1JBR0VfUFJFRklYKSk7XG4gICAgICAgIGF3YWl0IEFzeW5jU3RvcmFnZS5tdWx0aVJlbW92ZShmaWx0ZXJlZEtleXMpO1xuICAgICAgfVxuICAgICAgY2FsbGJhY2sgJiYgY2FsbGJhY2soKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBjYWxsYmFjayAmJiBjYWxsYmFjayhlKTtcbiAgICAgIHRocm93IGU7XG4gICAgfVxuICB9O1xufVxuXG4vLyBUaGlzIGNvZGVwYXRoIHdpbGwgbmV2ZXIgYmUgdHJpZ2dlcmVkIGluIFNESyAyOCBhbmQgYWJvdmVcbi8vIFRPRE86IHJlbW92ZSBiZWZvcmUgcmVsZWFzaW5nXG5mdW5jdGlvbiBfbGVnYWN5U2F2ZUNoYW5uZWwoaWQ6IHN0cmluZywgY2hhbm5lbDogQ2hhbm5lbCk6IFByb21pc2U8dm9pZD4ge1xuICByZXR1cm4gQXN5bmNTdG9yYWdlLnNldEl0ZW0oYCR7QVNZTkNfU1RPUkFHRV9QUkVGSVh9JHtpZH1gLCBKU09OLnN0cmluZ2lmeShjaGFubmVsKSk7XG59XG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgLyogT25seSB1c2VkIGludGVybmFsbHkgdG8gaW5pdGlhbGl6ZSB0aGUgbm90aWZpY2F0aW9uIGZyb20gdG9wIGxldmVsIHByb3BzICovXG4gIF9zZXRJbml0aWFsTm90aWZpY2F0aW9uKG5vdGlmaWNhdGlvbjogTm90aWZpY2F0aW9uKSB7XG4gICAgX2luaXRpYWxOb3RpZmljYXRpb24gPSBub3RpZmljYXRpb247XG4gIH0sXG5cbiAgLy8gVXNlciBwYXNzZXMgc2V0IG9mIGFjdGlvbnMgdGl0bGVzLlxuICBjcmVhdGVDYXRlZ29yeUFzeW5jKGNhdGVnb3J5SWQ6IHN0cmluZywgYWN0aW9uczogQWN0aW9uVHlwZVtdKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgcmV0dXJuIEV4cG9uZW50Tm90aWZpY2F0aW9ucy5jcmVhdGVDYXRlZ29yeUFzeW5jKGNhdGVnb3J5SWQsIGFjdGlvbnMpO1xuICB9LFxuXG4gIGRlbGV0ZUNhdGVnb3J5QXN5bmMoY2F0ZWdvcnlJZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgcmV0dXJuIEV4cG9uZW50Tm90aWZpY2F0aW9ucy5kZWxldGVDYXRlZ29yeUFzeW5jKGNhdGVnb3J5SWQpO1xuICB9LFxuXG4gIC8qIFJlLWV4cG9ydCAqL1xuICBnZXRFeHBvUHVzaFRva2VuQXN5bmMoKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICBpZiAoIUV4cG9uZW50Tm90aWZpY2F0aW9ucy5nZXRFeHBvbmVudFB1c2hUb2tlbkFzeW5jKSB7XG4gICAgICB0aHJvdyBuZXcgVW5hdmFpbGFiaWxpdHlFcnJvcignRXhwby5Ob3RpZmljYXRpb25zJywgJ2dldEV4cG9QdXNoVG9rZW5Bc3luYycpO1xuICAgIH1cbiAgICBpZiAoIUNvbnN0YW50cy5pc0RldmljZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBNdXN0IGJlIG9uIGEgcGh5c2ljYWwgZGV2aWNlIHRvIGdldCBhbiBFeHBvIFB1c2ggVG9rZW5gKTtcbiAgICB9XG4gICAgcmV0dXJuIEV4cG9uZW50Tm90aWZpY2F0aW9ucy5nZXRFeHBvbmVudFB1c2hUb2tlbkFzeW5jKCk7XG4gIH0sXG5cbiAgZ2V0RGV2aWNlUHVzaFRva2VuQXN5bmM6IChjb25maWc6IHtcbiAgICBnY21TZW5kZXJJZD86IHN0cmluZztcbiAgfSk6IFByb21pc2U8eyB0eXBlOiBzdHJpbmc7IGRhdGE6IHN0cmluZyB9PiA9PiB7XG4gICAgaWYgKCFFeHBvbmVudE5vdGlmaWNhdGlvbnMuZ2V0RGV2aWNlUHVzaFRva2VuQXN5bmMpIHtcbiAgICAgIHRocm93IG5ldyBVbmF2YWlsYWJpbGl0eUVycm9yKCdFeHBvLk5vdGlmaWNhdGlvbnMnLCAnZ2V0RGV2aWNlUHVzaFRva2VuQXN5bmMnKTtcbiAgICB9XG4gICAgcmV0dXJuIEV4cG9uZW50Tm90aWZpY2F0aW9ucy5nZXREZXZpY2VQdXNoVG9rZW5Bc3luYyhjb25maWcgfHwge30pO1xuICB9LFxuXG4gIGNyZWF0ZUNoYW5uZWxBbmRyb2lkQXN5bmMoaWQ6IHN0cmluZywgY2hhbm5lbDogQ2hhbm5lbCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmIChQbGF0Zm9ybS5PUyAhPT0gJ2FuZHJvaWQnKSB7XG4gICAgICBjb25zb2xlLndhcm4oYGNyZWF0ZUNoYW5uZWxBbmRyb2lkQXN5bmMoLi4uKSBoYXMgbm8gZWZmZWN0IG9uICR7UGxhdGZvcm0uT1N9YCk7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfVxuICAgIC8vIFRoaXMgY29kZXBhdGggd2lsbCBuZXZlciBiZSB0cmlnZ2VyZWQgaW4gU0RLIDI4IGFuZCBhYm92ZVxuICAgIC8vIFRPRE86IHJlbW92ZSBiZWZvcmUgcmVsZWFzaW5nXG4gICAgaWYgKCFJU19VU0lOR19ORVdfQklOQVJZKSB7XG4gICAgICByZXR1cm4gX2xlZ2FjeVNhdmVDaGFubmVsKGlkLCBjaGFubmVsKTtcbiAgICB9XG4gICAgcmV0dXJuIEV4cG9uZW50Tm90aWZpY2F0aW9ucy5jcmVhdGVDaGFubmVsKGlkLCBjaGFubmVsKTtcbiAgfSxcblxuICBkZWxldGVDaGFubmVsQW5kcm9pZEFzeW5jKGlkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAoUGxhdGZvcm0uT1MgIT09ICdhbmRyb2lkJykge1xuICAgICAgY29uc29sZS53YXJuKGBkZWxldGVDaGFubmVsQW5kcm9pZEFzeW5jKC4uLikgaGFzIG5vIGVmZmVjdCBvbiAke1BsYXRmb3JtLk9TfWApO1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgIH1cbiAgICAvLyBUaGlzIGNvZGVwYXRoIHdpbGwgbmV2ZXIgYmUgdHJpZ2dlcmVkIGluIFNESyAyOCBhbmQgYWJvdmVcbiAgICAvLyBUT0RPOiByZW1vdmUgYmVmb3JlIHJlbGVhc2luZ1xuICAgIGlmICghSVNfVVNJTkdfTkVXX0JJTkFSWSkge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgIH1cbiAgICByZXR1cm4gRXhwb25lbnROb3RpZmljYXRpb25zLmRlbGV0ZUNoYW5uZWwoaWQpO1xuICB9LFxuXG4gIC8qIFNob3dzIGEgbm90aWZpY2F0aW9uIGluc3RhbnRseSAqL1xuICBhc3luYyBwcmVzZW50TG9jYWxOb3RpZmljYXRpb25Bc3luYyhcbiAgICBub3RpZmljYXRpb246IExvY2FsTm90aWZpY2F0aW9uXG4gICk6IFByb21pc2U8TG9jYWxOb3RpZmljYXRpb25JZD4ge1xuICAgIF92YWxpZGF0ZU5vdGlmaWNhdGlvbihub3RpZmljYXRpb24pO1xuICAgIGxldCBuYXRpdmVOb3RpZmljYXRpb24gPSBfcHJvY2Vzc05vdGlmaWNhdGlvbihub3RpZmljYXRpb24pO1xuXG4gICAgaWYgKFBsYXRmb3JtLk9TICE9PSAnYW5kcm9pZCcpIHtcbiAgICAgIHJldHVybiBhd2FpdCBFeHBvbmVudE5vdGlmaWNhdGlvbnMucHJlc2VudExvY2FsTm90aWZpY2F0aW9uKG5hdGl2ZU5vdGlmaWNhdGlvbik7XG4gICAgfSBlbHNlIHtcbiAgICAgIGxldCBfY2hhbm5lbDtcbiAgICAgIGlmIChuYXRpdmVOb3RpZmljYXRpb24uY2hhbm5lbElkKSB7XG4gICAgICAgIF9jaGFubmVsID0gYXdhaXQgX2xlZ2FjeVJlYWRDaGFubmVsKG5hdGl2ZU5vdGlmaWNhdGlvbi5jaGFubmVsSWQpO1xuICAgICAgfVxuXG4gICAgICBpZiAoSVNfVVNJTkdfTkVXX0JJTkFSWSkge1xuICAgICAgICAvLyBkZWxldGUgdGhlIGxlZ2FjeSBjaGFubmVsIGZyb20gQXN5bmNTdG9yYWdlIHNvIHRoaXMgY29kZXBhdGggaXNuJ3QgdHJpZ2dlcmVkIGFueW1vcmVcbiAgICAgICAgX2xlZ2FjeURlbGV0ZUNoYW5uZWwobmF0aXZlTm90aWZpY2F0aW9uLmNoYW5uZWxJZCk7XG4gICAgICAgIHJldHVybiBFeHBvbmVudE5vdGlmaWNhdGlvbnMucHJlc2VudExvY2FsTm90aWZpY2F0aW9uV2l0aENoYW5uZWwoXG4gICAgICAgICAgbmF0aXZlTm90aWZpY2F0aW9uLFxuICAgICAgICAgIF9jaGFubmVsXG4gICAgICAgICk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBUT0RPOiByZW1vdmUgdGhpcyBjb2RlcGF0aCBiZWZvcmUgcmVsZWFzaW5nLCBpdCB3aWxsIG5ldmVyIGJlIHRyaWdnZXJlZCBvbiBTREsgMjgrXG4gICAgICAgIC8vIGNoYW5uZWwgZG9lcyBub3QgYWN0dWFsbHkgZXhpc3QsIHNvIGFkZCBpdHMgc2V0dGluZ3MgdG8gdGhlIGluZGl2aWR1YWwgbm90aWZpY2F0aW9uXG4gICAgICAgIGlmIChfY2hhbm5lbCkge1xuICAgICAgICAgIG5hdGl2ZU5vdGlmaWNhdGlvbi5zb3VuZCA9IF9jaGFubmVsLnNvdW5kO1xuICAgICAgICAgIG5hdGl2ZU5vdGlmaWNhdGlvbi5wcmlvcml0eSA9IF9jaGFubmVsLnByaW9yaXR5O1xuICAgICAgICAgIG5hdGl2ZU5vdGlmaWNhdGlvbi52aWJyYXRlID0gX2NoYW5uZWwudmlicmF0ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gRXhwb25lbnROb3RpZmljYXRpb25zLnByZXNlbnRMb2NhbE5vdGlmaWNhdGlvbihuYXRpdmVOb3RpZmljYXRpb24pO1xuICAgICAgfVxuICAgIH1cbiAgfSxcblxuICAvKiBTY2hlZHVsZSBhIG5vdGlmaWNhdGlvbiBhdCBhIGxhdGVyIGRhdGUgKi9cbiAgYXN5bmMgc2NoZWR1bGVMb2NhbE5vdGlmaWNhdGlvbkFzeW5jKFxuICAgIG5vdGlmaWNhdGlvbjogTG9jYWxOb3RpZmljYXRpb24sXG4gICAgb3B0aW9uczoge1xuICAgICAgdGltZT86IERhdGUgfCBudW1iZXI7XG4gICAgICByZXBlYXQ/OiAnbWludXRlJyB8ICdob3VyJyB8ICdkYXknIHwgJ3dlZWsnIHwgJ21vbnRoJyB8ICd5ZWFyJztcbiAgICAgIGludGVydmFsTXM/OiBudW1iZXI7XG4gICAgfSA9IHt9XG4gICk6IFByb21pc2U8TG9jYWxOb3RpZmljYXRpb25JZD4ge1xuICAgIC8vIHNldCBub3cgYXQgdGhlIGJlZ2lubmluZyBvZiB0aGUgbWV0aG9kLCB0byBwcmV2ZW50IHBvdGVudGlhbCB3ZWlyZCB3YXJuaW5ncyB3aGVuIHdlIHZhbGlkYXRlXG4gICAgLy8gb3B0aW9ucy50aW1lIGxhdGVyIG9uXG4gICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcblxuICAgIC8vIFZhbGlkYXRlIGFuZCBwcm9jZXNzIHRoZSBub3RpZmljYXRpb24gZGF0YVxuICAgIF92YWxpZGF0ZU5vdGlmaWNhdGlvbihub3RpZmljYXRpb24pO1xuICAgIGxldCBuYXRpdmVOb3RpZmljYXRpb24gPSBfcHJvY2Vzc05vdGlmaWNhdGlvbihub3RpZmljYXRpb24pO1xuXG4gICAgLy8gVmFsaWRhdGUgYG9wdGlvbnMudGltZWBcbiAgICBpZiAob3B0aW9ucy50aW1lKSB7XG4gICAgICBsZXQgdGltZUFzRGF0ZU9iajogRGF0ZSB8IG51bGwgPSBudWxsO1xuICAgICAgaWYgKG9wdGlvbnMudGltZSAmJiB0eXBlb2Ygb3B0aW9ucy50aW1lID09PSAnbnVtYmVyJykge1xuICAgICAgICB0aW1lQXNEYXRlT2JqID0gbmV3IERhdGUob3B0aW9ucy50aW1lKTtcbiAgICAgICAgaWYgKHRpbWVBc0RhdGVPYmoudG9TdHJpbmcoKSA9PT0gJ0ludmFsaWQgRGF0ZScpIHtcbiAgICAgICAgICB0aW1lQXNEYXRlT2JqID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChvcHRpb25zLnRpbWUgJiYgb3B0aW9ucy50aW1lIGluc3RhbmNlb2YgRGF0ZSkge1xuICAgICAgICB0aW1lQXNEYXRlT2JqID0gb3B0aW9ucy50aW1lO1xuICAgICAgfVxuXG4gICAgICAvLyBJZiB3ZSBjb3VsZG4ndCBjb252ZXJ0IHByb3Blcmx5LCB0aHJvdyBhbiBlcnJvclxuICAgICAgaWYgKCF0aW1lQXNEYXRlT2JqKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgICBgUHJvdmlkZWQgdmFsdWUgZm9yIFwidGltZVwiIGlzIGludmFsaWQuIFBsZWFzZSB2ZXJpZnkgdGhhdCBpdCdzIGVpdGhlciBhIG51bWJlciByZXByZXNlbnRpbmcgVW5peCBFcG9jaCB0aW1lIGluIG1pbGxpc2Vjb25kcywgb3IgYSB2YWxpZCBkYXRlIG9iamVjdC5gXG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIC8vIElmIHNvbWVvbmUgcGFzc2VzIGluIGEgdmFsdWUgdGhhdCBpcyB0b28gc21hbGwsIHNheSwgYnkgYW4gb3JkZXIgb2YgMTAwMCAoaXQncyBjb21tb24gdG9cbiAgICAgIC8vIGFjY2lkZW50bHkgcGFzcyBzZWNvbmRzIGluc3RlYWQgb2YgbXMpLCBkaXNwbGF5IGEgd2FybmluZy5cbiAgICAgIGlmICh0aW1lQXNEYXRlT2JqLmdldFRpbWUoKSA8IG5vdykge1xuICAgICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICAgYFByb3ZpZGVkIHZhbHVlIGZvciBcInRpbWVcIiBpcyBiZWZvcmUgdGhlIGN1cnJlbnQgZGF0ZS4gRGlkIHlvdSBwb3NzaWJseSBwYXNzIG51bWJlciBvZiBzZWNvbmRzIHNpbmNlIFVuaXggRXBvY2ggaW5zdGVhZCBvZiBudW1iZXIgb2YgbWlsbGlzZWNvbmRzP2BcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgb3B0aW9ucyA9IHtcbiAgICAgICAgLi4ub3B0aW9ucyxcbiAgICAgICAgdGltZTogdGltZUFzRGF0ZU9iai5nZXRUaW1lKCksXG4gICAgICB9O1xuICAgIH1cblxuICAgIGlmIChvcHRpb25zLmludGVydmFsTXMgIT0gbnVsbCAmJiBvcHRpb25zLnJlcGVhdCAhPSBudWxsKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFBhc3MgZWl0aGVyIHRoZSBcInJlcGVhdFwiIG9wdGlvbiBvciBcImludGVydmFsTXNcIiBvcHRpb24sIG5vdCBib3RoYCk7XG4gICAgfVxuXG4gICAgLy8gVmFsaWRhdGUgb3B0aW9ucy5yZXBlYXRcbiAgICBpZiAob3B0aW9ucy5yZXBlYXQgIT0gbnVsbCkge1xuICAgICAgY29uc3QgdmFsaWRPcHRpb25zID0gbmV3IFNldChbJ21pbnV0ZScsICdob3VyJywgJ2RheScsICd3ZWVrJywgJ21vbnRoJywgJ3llYXInXSk7XG4gICAgICBpZiAoIXZhbGlkT3B0aW9ucy5oYXMob3B0aW9ucy5yZXBlYXQpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgICBgUGFzcyBvbmUgb2YgWydtaW51dGUnLCAnaG91cicsICdkYXknLCAnd2VlaycsICdtb250aCcsICd5ZWFyJ10gYXMgdGhlIHZhbHVlIGZvciB0aGUgXCJyZXBlYXRcIiBvcHRpb25gXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKG9wdGlvbnMuaW50ZXJ2YWxNcyAhPSBudWxsKSB7XG4gICAgICBpZiAoUGxhdGZvcm0uT1MgPT09ICdpb3MnKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgVGhlIFwiaW50ZXJ2YWxNc1wiIG9wdGlvbiBpcyBub3Qgc3VwcG9ydGVkIG9uIGlPU2ApO1xuICAgICAgfVxuXG4gICAgICBpZiAob3B0aW9ucy5pbnRlcnZhbE1zIDw9IDAgfHwgIU51bWJlci5pc0ludGVnZXIob3B0aW9ucy5pbnRlcnZhbE1zKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICAgYFBhc3MgYW4gaW50ZWdlciBncmVhdGVyIHRoYW4gemVybyBhcyB0aGUgdmFsdWUgZm9yIHRoZSBcImludGVydmFsTXNcIiBvcHRpb25gXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKFBsYXRmb3JtLk9TICE9PSAnYW5kcm9pZCcpIHtcbiAgICAgIGlmIChvcHRpb25zLnJlcGVhdCkge1xuICAgICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICAgJ0FiaWxpdHkgdG8gc2NoZWR1bGUgYW4gYXV0b21hdGljYWxseSByZXBlYXRlZCBub3RpZmljYXRpb24gaXMgZGVwcmVjYXRlZCBvbiBpT1MgYW5kIHdpbGwgYmUgcmVtb3ZlZCBpbiB0aGUgbmV4dCBTREsgcmVsZWFzZS4nXG4gICAgICAgICk7XG4gICAgICAgIHJldHVybiBFeHBvbmVudE5vdGlmaWNhdGlvbnMubGVnYWN5U2NoZWR1bGVMb2NhbFJlcGVhdGluZ05vdGlmaWNhdGlvbihcbiAgICAgICAgICBuYXRpdmVOb3RpZmljYXRpb24sXG4gICAgICAgICAgb3B0aW9uc1xuICAgICAgICApO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gRXhwb25lbnROb3RpZmljYXRpb25zLnNjaGVkdWxlTG9jYWxOb3RpZmljYXRpb24obmF0aXZlTm90aWZpY2F0aW9uLCBvcHRpb25zKTtcbiAgICB9IGVsc2Uge1xuICAgICAgbGV0IF9jaGFubmVsO1xuICAgICAgaWYgKG5hdGl2ZU5vdGlmaWNhdGlvbi5jaGFubmVsSWQpIHtcbiAgICAgICAgX2NoYW5uZWwgPSBhd2FpdCBfbGVnYWN5UmVhZENoYW5uZWwobmF0aXZlTm90aWZpY2F0aW9uLmNoYW5uZWxJZCk7XG4gICAgICB9XG5cbiAgICAgIGlmIChJU19VU0lOR19ORVdfQklOQVJZKSB7XG4gICAgICAgIC8vIGRlbGV0ZSB0aGUgbGVnYWN5IGNoYW5uZWwgZnJvbSBBc3luY1N0b3JhZ2Ugc28gdGhpcyBjb2RlcGF0aCBpc24ndCB0cmlnZ2VyZWQgYW55bW9yZVxuICAgICAgICBfbGVnYWN5RGVsZXRlQ2hhbm5lbChuYXRpdmVOb3RpZmljYXRpb24uY2hhbm5lbElkKTtcbiAgICAgICAgcmV0dXJuIEV4cG9uZW50Tm90aWZpY2F0aW9ucy5zY2hlZHVsZUxvY2FsTm90aWZpY2F0aW9uV2l0aENoYW5uZWwoXG4gICAgICAgICAgbmF0aXZlTm90aWZpY2F0aW9uLFxuICAgICAgICAgIG9wdGlvbnMsXG4gICAgICAgICAgX2NoYW5uZWxcbiAgICAgICAgKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIFRPRE86IHJlbW92ZSB0aGlzIGNvZGVwYXRoIGJlZm9yZSByZWxlYXNpbmcsIGl0IHdpbGwgbmV2ZXIgYmUgdHJpZ2dlcmVkIG9uIFNESyAyOCtcbiAgICAgICAgLy8gY2hhbm5lbCBkb2VzIG5vdCBhY3R1YWxseSBleGlzdCwgc28gYWRkIGl0cyBzZXR0aW5ncyB0byB0aGUgaW5kaXZpZHVhbCBub3RpZmljYXRpb25cbiAgICAgICAgaWYgKF9jaGFubmVsKSB7XG4gICAgICAgICAgbmF0aXZlTm90aWZpY2F0aW9uLnNvdW5kID0gX2NoYW5uZWwuc291bmQ7XG4gICAgICAgICAgbmF0aXZlTm90aWZpY2F0aW9uLnByaW9yaXR5ID0gX2NoYW5uZWwucHJpb3JpdHk7XG4gICAgICAgICAgbmF0aXZlTm90aWZpY2F0aW9uLnZpYnJhdGUgPSBfY2hhbm5lbC52aWJyYXRlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBFeHBvbmVudE5vdGlmaWNhdGlvbnMuc2NoZWR1bGVMb2NhbE5vdGlmaWNhdGlvbihuYXRpdmVOb3RpZmljYXRpb24sIG9wdGlvbnMpO1xuICAgICAgfVxuICAgIH1cbiAgfSxcblxuICAvKiBEaXNtaXNzIGN1cnJlbnRseSBzaG93biBub3RpZmljYXRpb24gd2l0aCBJRCAoQW5kcm9pZCBvbmx5KSAqL1xuICBhc3luYyBkaXNtaXNzTm90aWZpY2F0aW9uQXN5bmMobm90aWZpY2F0aW9uSWQ6IExvY2FsTm90aWZpY2F0aW9uSWQpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAoIUV4cG9uZW50Tm90aWZpY2F0aW9ucy5kaXNtaXNzTm90aWZpY2F0aW9uKSB7XG4gICAgICB0aHJvdyBuZXcgVW5hdmFpbGFiaWxpdHlFcnJvcignRXhwby5Ob3RpZmljYXRpb25zJywgJ2Rpc21pc3NOb3RpZmljYXRpb24nKTtcbiAgICB9XG4gICAgcmV0dXJuIGF3YWl0IEV4cG9uZW50Tm90aWZpY2F0aW9ucy5kaXNtaXNzTm90aWZpY2F0aW9uKG5vdGlmaWNhdGlvbklkKTtcbiAgfSxcblxuICAvKiBEaXNtaXNzIGFsbCBjdXJyZW50bHkgc2hvd24gbm90aWZpY2F0aW9ucyAoQW5kcm9pZCBvbmx5KSAqL1xuICBhc3luYyBkaXNtaXNzQWxsTm90aWZpY2F0aW9uc0FzeW5jKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICghRXhwb25lbnROb3RpZmljYXRpb25zLmRpc21pc3NBbGxOb3RpZmljYXRpb25zKSB7XG4gICAgICB0aHJvdyBuZXcgVW5hdmFpbGFiaWxpdHlFcnJvcignRXhwby5Ob3RpZmljYXRpb25zJywgJ2Rpc21pc3NBbGxOb3RpZmljYXRpb25zJyk7XG4gICAgfVxuICAgIHJldHVybiBhd2FpdCBFeHBvbmVudE5vdGlmaWNhdGlvbnMuZGlzbWlzc0FsbE5vdGlmaWNhdGlvbnMoKTtcbiAgfSxcblxuICAvKiBDYW5jZWwgc2NoZWR1bGVkIG5vdGlmaWNhdGlvbiBub3RpZmljYXRpb24gd2l0aCBJRCAqL1xuICBjYW5jZWxTY2hlZHVsZWROb3RpZmljYXRpb25Bc3luYyhub3RpZmljYXRpb25JZDogTG9jYWxOb3RpZmljYXRpb25JZCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmIChQbGF0Zm9ybS5PUyA9PT0gJ2FuZHJvaWQnICYmIHR5cGVvZiBub3RpZmljYXRpb25JZCA9PT0gJ3N0cmluZycpIHtcbiAgICAgIHJldHVybiBFeHBvbmVudE5vdGlmaWNhdGlvbnMuY2FuY2VsU2NoZWR1bGVkTm90aWZpY2F0aW9uV2l0aFN0cmluZ0lkQXN5bmMobm90aWZpY2F0aW9uSWQpO1xuICAgIH1cbiAgICByZXR1cm4gRXhwb25lbnROb3RpZmljYXRpb25zLmNhbmNlbFNjaGVkdWxlZE5vdGlmaWNhdGlvbkFzeW5jKG5vdGlmaWNhdGlvbklkKTtcbiAgfSxcblxuICAvKiBDYW5jZWwgYWxsIHNjaGVkdWxlZCBub3RpZmljYXRpb25zICovXG4gIGNhbmNlbEFsbFNjaGVkdWxlZE5vdGlmaWNhdGlvbnNBc3luYygpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICByZXR1cm4gRXhwb25lbnROb3RpZmljYXRpb25zLmNhbmNlbEFsbFNjaGVkdWxlZE5vdGlmaWNhdGlvbnNBc3luYygpO1xuICB9LFxuXG4gIC8qIFByaW1hcnkgcHVibGljIGFwaSAqL1xuICBhZGRMaXN0ZW5lcihsaXN0ZW5lcjogKG5vdGlmaWNhdGlvbjogTm90aWZpY2F0aW9uKSA9PiB1bmtub3duKTogRXZlbnRTdWJzY3JpcHRpb24ge1xuICAgIF9tYXliZUluaXRFbWl0dGVyKCk7XG5cbiAgICBpZiAoX2luaXRpYWxOb3RpZmljYXRpb24pIHtcbiAgICAgIGNvbnN0IGluaXRpYWxOb3RpZmljYXRpb24gPSBfaW5pdGlhbE5vdGlmaWNhdGlvbjtcbiAgICAgIF9pbml0aWFsTm90aWZpY2F0aW9uID0gbnVsbDtcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBlbWl0Tm90aWZpY2F0aW9uKGluaXRpYWxOb3RpZmljYXRpb24pO1xuICAgICAgfSwgMCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIF9lbWl0dGVyLmFkZExpc3RlbmVyKCdub3RpZmljYXRpb24nLCBsaXN0ZW5lcik7XG4gIH0sXG5cbiAgYXN5bmMgZ2V0QmFkZ2VOdW1iZXJBc3luYygpOiBQcm9taXNlPG51bWJlcj4ge1xuICAgIGlmICghRXhwb25lbnROb3RpZmljYXRpb25zLmdldEJhZGdlTnVtYmVyQXN5bmMpIHtcbiAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgICByZXR1cm4gRXhwb25lbnROb3RpZmljYXRpb25zLmdldEJhZGdlTnVtYmVyQXN5bmMoKTtcbiAgfSxcblxuICBhc3luYyBzZXRCYWRnZU51bWJlckFzeW5jKG51bWJlcjogbnVtYmVyKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgaWYgKCFFeHBvbmVudE5vdGlmaWNhdGlvbnMuc2V0QmFkZ2VOdW1iZXJBc3luYykge1xuICAgICAgdGhyb3cgbmV3IFVuYXZhaWxhYmlsaXR5RXJyb3IoJ0V4cG8uTm90aWZpY2F0aW9ucycsICdzZXRCYWRnZU51bWJlckFzeW5jJyk7XG4gICAgfVxuICAgIHJldHVybiBFeHBvbmVudE5vdGlmaWNhdGlvbnMuc2V0QmFkZ2VOdW1iZXJBc3luYyhudW1iZXIpO1xuICB9LFxuXG4gIGFzeW5jIHNjaGVkdWxlTm90aWZpY2F0aW9uV2l0aENhbGVuZGFyQXN5bmMoXG4gICAgbm90aWZpY2F0aW9uOiBMb2NhbE5vdGlmaWNhdGlvbixcbiAgICBvcHRpb25zOiB7XG4gICAgICB5ZWFyPzogbnVtYmVyO1xuICAgICAgbW9udGg/OiBudW1iZXI7XG4gICAgICBob3VyPzogbnVtYmVyO1xuICAgICAgZGF5PzogbnVtYmVyO1xuICAgICAgbWludXRlPzogbnVtYmVyO1xuICAgICAgc2Vjb25kPzogbnVtYmVyO1xuICAgICAgd2Vla0RheT86IG51bWJlcjtcbiAgICAgIHJlcGVhdD86IGJvb2xlYW47XG4gICAgfSA9IHt9XG4gICk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgY29uc3QgYXJlT3B0aW9uc1ZhbGlkOiBib29sZWFuID1cbiAgICAgIChvcHRpb25zLm1vbnRoID09IG51bGwgfHwgaXNJblJhbmdlSW5jbHVzaXZlKG9wdGlvbnMubW9udGgsIDEsIDEyKSkgJiZcbiAgICAgIChvcHRpb25zLmRheSA9PSBudWxsIHx8IGlzSW5SYW5nZUluY2x1c2l2ZShvcHRpb25zLmRheSwgMSwgMzEpKSAmJlxuICAgICAgKG9wdGlvbnMuaG91ciA9PSBudWxsIHx8IGlzSW5SYW5nZUluY2x1c2l2ZShvcHRpb25zLmhvdXIsIDAsIDIzKSkgJiZcbiAgICAgIChvcHRpb25zLm1pbnV0ZSA9PSBudWxsIHx8IGlzSW5SYW5nZUluY2x1c2l2ZShvcHRpb25zLm1pbnV0ZSwgMCwgNTkpKSAmJlxuICAgICAgKG9wdGlvbnMuc2Vjb25kID09IG51bGwgfHwgaXNJblJhbmdlSW5jbHVzaXZlKG9wdGlvbnMuc2Vjb25kLCAwLCA1OSkpICYmXG4gICAgICAob3B0aW9ucy53ZWVrRGF5ID09IG51bGwgfHwgaXNJblJhbmdlSW5jbHVzaXZlKG9wdGlvbnMud2Vla0RheSwgMSwgNykpICYmXG4gICAgICAob3B0aW9ucy53ZWVrRGF5ID09IG51bGwgfHwgb3B0aW9ucy5kYXkgPT0gbnVsbCk7XG5cbiAgICBpZiAoIWFyZU9wdGlvbnNWYWxpZCkge1xuICAgICAgdGhyb3cgbmV3IENvZGVkRXJyb3IoXG4gICAgICAgICdXUk9OR19PUFRJT05TJyxcbiAgICAgICAgJ09wdGlvbnMgaW4gc2NoZWR1bGVOb3RpZmljYXRpb25XaXRoQ2FsZW5kYXJBc3luYyBjYWxsIHdlcmUgaW5jb3JyZWN0ISdcbiAgICAgICk7XG4gICAgfVxuXG4gICAgX3ZhbGlkYXRlTm90aWZpY2F0aW9uKG5vdGlmaWNhdGlvbik7XG4gICAgbGV0IG5hdGl2ZU5vdGlmaWNhdGlvbiA9IF9wcm9jZXNzTm90aWZpY2F0aW9uKG5vdGlmaWNhdGlvbik7XG5cbiAgICByZXR1cm4gRXhwb25lbnROb3RpZmljYXRpb25zLnNjaGVkdWxlTm90aWZpY2F0aW9uV2l0aENhbGVuZGFyKG5hdGl2ZU5vdGlmaWNhdGlvbiwgb3B0aW9ucyk7XG4gIH0sXG5cbiAgYXN5bmMgc2NoZWR1bGVOb3RpZmljYXRpb25XaXRoVGltZXJBc3luYyhcbiAgICBub3RpZmljYXRpb246IExvY2FsTm90aWZpY2F0aW9uLFxuICAgIG9wdGlvbnM6IHtcbiAgICAgIGludGVydmFsOiBudW1iZXI7XG4gICAgICByZXBlYXQ/OiBib29sZWFuO1xuICAgIH1cbiAgKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICBpZiAob3B0aW9ucy5pbnRlcnZhbCA8IDEpIHtcbiAgICAgIHRocm93IG5ldyBDb2RlZEVycm9yKCdXUk9OR19PUFRJT05TJywgJ0ludGVydmFsIG11c3QgYmUgbm90IGxlc3MgdGhlbiAxJyk7XG4gICAgfVxuXG4gICAgX3ZhbGlkYXRlTm90aWZpY2F0aW9uKG5vdGlmaWNhdGlvbik7XG4gICAgbGV0IG5hdGl2ZU5vdGlmaWNhdGlvbiA9IF9wcm9jZXNzTm90aWZpY2F0aW9uKG5vdGlmaWNhdGlvbik7XG5cbiAgICByZXR1cm4gRXhwb25lbnROb3RpZmljYXRpb25zLnNjaGVkdWxlTm90aWZpY2F0aW9uV2l0aFRpbWVyKG5hdGl2ZU5vdGlmaWNhdGlvbiwgb3B0aW9ucyk7XG4gIH0sXG59O1xuXG5mdW5jdGlvbiBpc0luUmFuZ2VJbmNsdXNpdmUodmFyaWFibGU6IG51bWJlciwgbWluOiBudW1iZXIsIG1heDogbnVtYmVyKTogYm9vbGVhbiB7XG4gIHJldHVybiB2YXJpYWJsZSA+PSBtaW4gJiYgdmFyaWFibGUgPD0gbWF4O1xufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==